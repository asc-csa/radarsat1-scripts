# This file contains the list of files to download, based off the find_if_has_imagery.py script.
# We have pre-compiled a set of lakes at 0% and 100% ice coverage that can be used for analysis.
# These images are downloaded from the RADARSAT-1 bucket.

import boto3
from botocore.config import Config
from botocore import UNSIGNED
import os

# SETUP
MY_CONFIG = Config(
    region_name = 'ca-central-1',
    signature_version = UNSIGNED,
    retries = {
        'max_attempts': 10,
        'mode': 'standard'
    }
)
BUCKET_NAME = 'radarsat-r1-l1-cog'
S3_CLIENT = boto3.client('s3', config=MY_CONFIG)
S3_RESOURCE = boto3.resource('s3', config=MY_CONFIG)

def download_file(file_name):
    """ Download a file from the RADARSAT-1 bucket.

    :param file_name: Name of the file to download
    """
    try:
        # If that location does not already exist, we create it.
        if not os.path.exists(os.path.dirname(file_name)):
            os.makedirs(os.path.dirname(file_name))
        print("Downloading:", file_name)
        bucket = S3_RESOURCE.Bucket(BUCKET_NAME)
        bucket.download_file(file_name, file_name)
    except Exception as e:
        print(e)

# These are validated images containing lakes at 100% and 0% ice coverage
hundred = ['2001/3/RS1_M0246591_F5_20010318_232514_HH_SGF.tif', '2005/2/RS1_X0487204_SCWA_20050226_063018_HH_SCW.tif', '2010/2/RS1_B0596353_SCWB_20100213_100906_HH_SCW01F.tif', '2010/3/RS1_B0596632_SCWB_20100302_213741_HH_SCW01F.tif', '2010/4/RS1_A0598762_SCWA_20100419_213730_HH_SCW01F.tif', '2001/5/RS1_X0492940_SCWA_20010518_100009_HH_SCW.tif', '2002/5/RS1_X0492952_SCWA_20020523_100756_HH_SCW.tif', '2005/5/RS1_X0492850_SCWA_20050525_211044_HH_SCW.tif', '2001/5/RS1_X0492953_SCWA_20010503_103627_HH_SCW.tif', '2001/12/RS1_X0492707_SCWA_20011205_093635_HH_SCW.tif', '2002/5/RS1_X0492654_SCWA_20020522_103730_HH_SCW.tif', '2005/1/RS1_X0492713_SCWA_20050106_093458_HH_SCW.tif', '2001/2/RS1_M0241608_F4_20010207_222110_HH_SGF.tif', '2005/3/RS1_M0700225_S7_20050321_102048_HH_SGF.tif', '2007/3/RS1_M0700236_S2_20070317_220551_HH_SGF.tif', '2008/4/RS1_M0700240_S4_20080401_103230_HH_SGF.tif', '2010/1/RS1_B0595715_SCWB_20100116_102821_HH_SCW01F.tif', '2013/1/RS1_A0629816_SCWA_20130106_221505_HH_SCW01F.tif', '2013/2/RS1_A0630434_SCWA_20130206_221102_HH_SCW01F.tif', '2013/3/RS1_A0631082_SCWA_20130302_221112_HH_SCW01F.tif', '2002/5/RS1_X0492948_SCWA_20020509_101737_HH_SCW.tif', '2004/11/RS1_X0492820_SCWA_20041117_202340_HH_SCW.tif', '2012/12/RS1_B0629046_SCWA_20121206_141612_HH_SCW01F.tif', '2001/1/RS1_X0498258_SCWA_20010103_061947_HH_SCW.tif', '2006/1/RS1_X0498556_SCWA_20060125_061518_HH_SCW.tif', '2007/1/RS1_X0498531_SCWB_20070127_173734_HH_SCW.tif', '1999/3/RS1_M0634669_F3F_19990307_110500_HH_SLC.tif', '1999/4/RS1_M0634672_F3F_19990424_110503_HH_SLC.tif', '2002/5/RS1_M0630898_F2N_20020518_225811_HH_SLC.tif', '2013/1/RS1_C0629658_SCWA_20130102_111117_HH_SCW01F.tif']
zero = ['2004/9/RS1_P0388699_F1_20040924_231436_HH_SGF.tif', '2012/5/RS1_A0621128_SCWA_20120503_112710_HH_SCW01F.tif', '2001/8/RS1_P0590667_S1_20010802_102424_HH_SLC.tif', '2012/6/RS1_B0622998_SCWA_20120626_100936_HH_SCW01F.tif', '2008/8/RS1_P0590670_S5_20080803_213832_HH_SLC.tif', '2000/10/RS1_X0479395_F1_20001021_095628_HH_SGF.tif', '2002/7/RS1_X0492961_SCWA_20020703_101325_HH_SCW.tif', '2004/7/RS1_X0492976_SCWA_20040723_100642_HH_SCW.tif', '1998/10/RS1_X0492758_SCWB_19981008_212713_HH_SCW.tif', '1999/10/RS1_X0492772_SCWB_19991017_211905_HH_SCW.tif', '2003/7/RS1_X0492752_SCWA_20030702_212528_HH_SCW.tif', '2005/10/RS1_X0492714_SCWA_20051014_103843_HH_SCW.tif', '2003/6/RS1_M0700212_S7_20030607_222819_HH_SGF.tif', '2003/8/RS1_M0700214_S4_20030802_103412_HH_SGF.tif', '2005/6/RS1_M0700227_S4_20050604_103315_HH_SGF.tif', '2007/6/RS1_M0700239_S4_20070607_221409_HH_SGF.tif', '2008/8/RS1_M0700276_W2_20080812_221408_HH_SGF.tif', '2012/7/RS1_G0623257_S4_20120705_221105_HH_SGF01F.tif', '2012/9/RS1_G0626115_S3_20120919_103416_HH_SGF01F.tif', '2011/10/RS1_G1615777_SCNA_20111012_103706_HH_SCN01F.tif', '2002/11/RS1_X0492818_SCWA_20021121_202844_HH_SCW.tif', '2003/7/RS1_X0492847_SCWA_20030702_212414_HH_SCW.tif', '2004/7/RS1_X0492975_SCWA_20040716_101101_HH_SCW.tif', '2001/6/RS1_X0498114_SCWA_20010603_184027_HH_SCW.tif', '2005/7/RS1_X0498444_SCWA_20050717_184222_HH_SCW.tif', '2006/7/RS1_X0498476_SCWB_20060702_183342_HH_SCW.tif', '1999/10/RS1_M0630892_F2N_19991001_225907_HH_SLC.tif', '1999/11/RS1_M0634678_F3F_19991102_110504_HH_SLC.tif', '2001/9/RS1_M0630895_F2N_20010920_225830_HH_SLC.tif', '2008/9/RS1_M0634777_F3_20080915_110151_HH_SLC.tif']

# We can iterate through those lists to download them.
for file in hundred:
    download_file(file)

for file in zero:
    download_file(file)